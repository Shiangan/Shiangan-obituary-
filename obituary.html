<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訃聞內頁</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
    <style>
        body {
            font-family: '微軟正黑體', Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4FBDBC;
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 2rem;
        }
        .container {
            width: 80%;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .main-photo img {
            width: 100%;
            border-radius: 8px;
        }
        .timeline {
            margin: 2rem 0;
            position: relative;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #4FBDBC;
        }
        .timeline-item {
            position: relative;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 45%;
            float: left;
        }
        .timeline-item:nth-child(odd) {
            clear: both;
        }
        .timeline-item:nth-child(even) {
            float: right;
            margin-left: 50%;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background-color: #4FBDBC;
            border-radius: 50%;
        }
        .carousel {
            margin: 2rem 0;
        }
        .carousel img {
            width: 100%;
            border-radius: 8px;
        }
        .comments-section {
            margin-top: 2rem;
        }
        .comment {
            background-color: #f9f9f9;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .comment-name {
            font-weight: bold;
        }
        .comment-content {
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <header>訃聞內頁</header>
    <div class="container">
        <div class="main-photo">
            <img id="mainPhoto" alt="主照片">
        </div>
        <h2 id="deceasedName"></h2>
        <p>性別: <span id="gender"></span></p>
        <p>享年: <span id="age"></span></p>
        <p>逝世日期: <span id="dateOfDeath"></span></p>
        
        <div id="obituaryPhotosContainer" class="obituary-photos"></div>

        <p id="placardLocationContainer"></p>
        <p id="funeralDateContainer"></p>
        <p id="funeralLocationContainer"></p>

        <div id="memorialPhotosContainer" class="carousel">
            <div class="slick-carousel" id="memorial-photos">
                <!-- 追思照片輪播內容會在此注入 -->
            </div>
        </div>

        <section class="comments-section">
            <h3>留言區</h3>
            <div id="commentsContainer"></div>
            <form id="commentForm">
                <label for="commentName">姓名</label>
                <input type="text" id="commentName" name="commentName" required>

                <label for="commentContent">留言</label>
                <textarea id="commentContent" name="commentContent" required></textarea>

                <button type="button" onclick="submitComment()">提交留言</button>
            </form>
        </section>
    </div>

    <audio id="backgroundMusic" loop></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mainPhoto = localStorage.getItem('mainPhoto');
            const deceasedName = localStorage.getItem('deceasedName');
            const gender = localStorage.getItem('gender');
            const age = localStorage.getItem('age');
            const dateOfDeath = localStorage.getItem('dateOfDeath');
            const obituaryPhotos = JSON.parse(localStorage.getItem('obituaryPhotos')) || [];
            const placardLocation = localStorage.getItem('placardLocation');
            const funeralDate = localStorage.getItem('funeralDate');
            const funeralLocation = localStorage.getItem('funeralLocation');
            const memorialPhotos = JSON.parse(localStorage.getItem('memorialPhotos')) || [];
            const audioFile = localStorage.getItem('audioFile');

            document.getElementById('mainPhoto').src = mainPhoto;
            document.getElementById('deceasedName').textContent = deceasedName;
            document.getElementById('gender').textContent = gender;
            document.getElementById('age').textContent = age;
            document.getElementById('dateOfDeath').textContent = dateOfDeath;

            if (obituaryPhotos.length > 0) {
                const obituaryPhotosContainer = document.getElementById('obituaryPhotosContainer');
                obituaryPhotos.forEach(photo => {
                    const img = document.createElement('img');
                    img.src = photo;
                    img.classList.add('obituary-photo');
                    obituaryPhotosContainer.appendChild(img);
                });
            }

            if (placardLocation) {
                document.getElementById('placardLocationContainer').textContent = `靈位位置: ${placardLocation}`;
            }

            if (funeralDate) {
                document.getElementById('funeralDateContainer').textContent = `告別式日期: ${funeralDate}`;
            }

            if (funeralLocation) {
                document.getElementById('funeralLocationContainer').textContent = `告別式地點: ${funeralLocation}`;
            }

                if (memorialPhotos.length > 0) {
                const carouselContainer = document.getElementById('memorial-photos');
                memorialPhotos.forEach(photo => {
                    const img = document.createElement('img');
                    img.src = photo;
                    img.alt = '回憶照片';
                    carouselContainer.appendChild(img);
                });

                $('.slick-carousel').slick({
                    infinite: true,
                    slidesToShow: 3,
                    slidesToScroll: 1,
                    autoplay: true,
                    autoplaySpeed: 3000,
                    arrows: true,
                    dots: true
                });
            }

              if (audioFile) {
                  const audioElement = document.getElementById('backgroundMusic');
                  audioElement.src = audioFile;
                  audioElement.play();
              }
          });

          function submitComment() {
              const name = document.getElementById('commentName').value;
              const content = document.getElementById('commentContent').value;

              if (name && content) {
                  const commentContainer = document.getElementById('commentsContainer');
                  const commentDiv = document.createElement('div');
                  commentDiv.className = 'comment';
                  commentDiv.innerHTML = `
                      <p class="comment-name">${name}</p>
                      <p class="comment-content">${content}</p>
                  `;
                  commentContainer.appendChild(commentDiv);

                  // Clear form fields
                  document.getElementById('commentName').value = '';
                  document.getElementById('commentContent').value = '';
              }
          }
      </script>
  </body>
  </html>

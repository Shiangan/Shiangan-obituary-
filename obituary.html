<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訃聞</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
</head>
<body>
    <header>
        <h1>訃聞</h1>
    </header>
    <div class="container">
        <div id="obituary">
            <h2>{{ deceasedName }}</h2>
            <p>性別: {{ gender }}</p>
            <p>年齡: {{ age }}</p>
            <p>逝世日期: {{ dateOfDeath }}</p>
            <img :src="mainPhoto" alt="主要照片" class="main-photo">

            <div v-if="obituaryPhotos.length > 0">
                <h3>訃聞照片</h3>
                <div v-for="photo in obituaryPhotos" :key="photo">
                    <img :src="photo" alt="訃聞照片" class="obituary-photo">
                </div>
            </div>

            <p>設立牌位地點: {{ placardLocation }}</p>
            <p>出殯日期: {{ funeralDate }}</p>
            <p>出殯地點: {{ funeralLocation }}</p>

            <div v-if="memorialPhotos.length > 0">
                <h3>追思照片</h3>
                <div class="carousel">
                    <div v-for="photo in memorialPhotos" :key="photo" class="carousel-item">
                        <img :src="photo" alt="追思照片" class="memorial-photo">
                    </div>
                </div>
            </div>

            <div>
                <h3>播放音樂</h3>
                <audio :src="audioUrl" controls autoplay></audio>
            </div>

            <div>
                <h3>致贈花籃請點選我</h3>
                <a href="flower-order.html" class="flower-order-link">訂購花籃</a>
            </div>

            <div>
                <h3>留言區</h3>
                <div class="comments">
                    <textarea v-model="newComment" placeholder="寫下您的追思"></textarea>
                    <button @click="addComment">提交留言</button>
                    <ul>
                        <li v-for="comment in comments" :key="comment">{{ comment }}</li>
                    </ul>
                </div>
            </div>

            <div>
                <h3>殯儀服務提供者</h3>
                <p>祥安生命有限公司</p>
                <p>聯絡電話: +886978583699</p>
                <p>殯儀總監: 陳妍如</p>
            </div>
        </div>
    </div>

    <script>
        new Vue({
            el: '#obituary',
            data: {
                deceasedName: localStorage.getItem('deceasedName'),
                gender: localStorage.getItem('gender'),
                age: localStorage.getItem('age'),
                dateOfDeath: localStorage.getItem('dateOfDeath'),
                mainPhoto: localStorage.getItem('mainPhoto'),
                obituaryPhotos: JSON.parse(localStorage.getItem('obituaryPhotos')),
                placardLocation: localStorage.getItem('placardLocation'),
                funeralDate: localStorage.getItem('funeralDate'),
                funeralLocation: localStorage.getItem('funeralLocation'),
                memorialPhotos: JSON.parse(localStorage.getItem('memorialPhotos')),
                audioUrl: localStorage.getItem('audioUrl'),
                comments: [],
                newComment: ''
            },
            methods: {
                addComment() {
                    if (this.newComment.trim()) {
                        this.comments.push(this.newComment.trim());
                        this.newComment = '';
                    }
                }
            }
        });

        // 初始化輪播
        document.addEventListener('DOMContentLoaded', function () {
            const carouselItems = document.querySelectorAll('.carousel-item');
            let currentIndex = 0;

            function showCurrent() {
                carouselItems.forEach((item, index) => {
                    item.style.display = index === currentIndex ? 'block' : 'none';
                });
            }

            function nextSlide() {
                currentIndex = (currentIndex + 1) % carouselItems.length;
                showCurrent();
            }

            if (carouselItems.length > 0) {
                showCurrent();
                setInterval(nextSlide, 3000); // 每3秒切換一次
            }
        });
    </script>
</body>
</html>
